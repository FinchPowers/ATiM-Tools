<?php
session_start(); 
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"formBuilderTest\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"test\",  \"plugin\" : \"mPlugin\",  \"model\" : \"mModel\",  \"tablename\" : \"mTablename\",  \"language_label\" : \"mLanguage\",  \"language_tag\" : \"mTag\",  \"type\" : \"input\",  \"setting\" : \"mSetting\",  \"default\" : \"mDefault\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"mHelp\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"mHeading\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"\",  \"sfo_id\" : \"\" , \"flag_confidential\" : \"0\" } ] }",
		"result" => "INSERT INTO structures(`alias`) VALUES ('formBuilderTest');

INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('mPlugin', 'mModel', 'mTablename', 'test', 'input',  NULL , '0', 'mSetting', 'mDefault', 'mHelp', 'mLanguage', 'mTag');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`) VALUES 
((SELECT id FROM structures WHERE alias='formBuilderTest'), (SELECT id FROM structure_fields WHERE `model`='mModel' AND `tablename`='mTablename' AND `field`='test' AND `type`='input' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='mSetting' AND `default`='mDefault' AND `language_help`='mHelp' AND `language_label`='mLanguage' AND `language_tag`='mTag'), '1', '2', 'mHeading', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '1', '0', '1', '0', '1', '0', '1', '0', '1', '0', '0', '0', '1', '0', '1');",
		"description" => "New structure, single new field");

	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"formBuilderTest\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"first_name\",  \"plugin\" : \"Clinicalannotation\",  \"model\" : \"Participant\",  \"tablename\" : \"participants\",  \"language_label\" : \"first name\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"\",  \"display_column\" : \"1\",  \"display_order\" : \"3\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"1\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"1\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"1\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"1\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"1\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"\",  \"sfo_id\" : \"\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "INSERT INTO structures(`alias`) VALUES ('formBuilderTest');

INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`) VALUES 
((SELECT id FROM structures WHERE alias='formBuilderTest'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='first_name' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0'), '1', '3', '', '1', 'first name', '0', '', '1', '', '0', '', '1', '', '0', '', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '0', '0', '1', '1', '1');",
		"description" => "New structure, single existing sfi (participant first_name)"	
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "-- delete structure_formats
DELETE FROM structure_formats WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `public_identifier`='' AND `plugin`='Administrate' AND `model`='User' AND `tablename`='users' AND `field`='password' AND `language_label`='password' AND `language_tag`='' AND `type`='password' AND `setting`='size=20' AND `default`='' AND `structure_value_domain` IS NULL  AND `language_help`='login_help' AND `validation_control`='open' AND `value_domain_control`='open' AND `field_control`='open' AND `flag_confidential`='0');",
		"description" => "Deleting login.password"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\" }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username2\",  \"language_tag\" : \"\",  \"type\" : \"select\",  \"setting\" : \"size=20\",  \"default\" : \"mDef\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"mHelp\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"mHead\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\" } ] }",
		"result" => "UPDATE structure_formats SET `language_heading`='mHead', `flag_override_label`='1', `language_label`='username2', `flag_override_help`='1', `language_help`='mHelp', `flag_override_type`='1', `type`='select', `flag_override_default`='1', `default`='mDef' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update a login.username field with overrides"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"0\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"0\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"0\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_add`='0', `flag_edit`='0', `flag_search`='0', `flag_addgrid`='0', `flag_editgrid`='0', `flag_index`='0', `flag_detail`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_x"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"0\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_add`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_add"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"0\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_edit`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_edit"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_search`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_search"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_addgrid`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_addgrid"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_editgrid`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_editgrid"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"0\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_index`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_index"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_detail`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_detail"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"0\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_summary`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_summary"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"1\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "UPDATE structure_formats SET `flag_batchedit`='1' WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Update login.username flag_batchedit"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"collections\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"acquisition_label\",  \"plugin\" : \"Inventorymanagement\",  \"model\" : \"Collection\",  \"tablename\" : \"collections\",  \"language_label\" : \"acquisition_label\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"inv_acquisition_label_defintion\",  \"display_column\" : \"0\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"1\",  \"sfi_id\" : \"152\",  \"sfo_id\" : \"161\" }, {  \"field\" : \"bank_id\",  \"plugin\" : \"Inventorymanagement\",  \"model\" : \"Collection\",  \"tablename\" : \"collections\",  \"language_label\" : \"collection bank\",  \"language_tag\" : \"\",  \"type\" : \"select\",  \"setting\" : \"\",  \"default\" : \"\",  \"structure_value_domain\" : \"banks\",  \"language_help\" : \"inv_collection_bank_defintion\",  \"display_column\" : \"0\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"1\",  \"sfi_id\" : \"333\",  \"sfo_id\" : \"162\" }, {  \"field\" : \"collection_site\",  \"plugin\" : \"Inventorymanagement\",  \"model\" : \"Collection\",  \"tablename\" : \"collections\",  \"language_label\" : \"collection site\",  \"language_tag\" : \"\",  \"type\" : \"select\",  \"setting\" : \"\",  \"default\" : \"\",  \"structure_value_domain\" : \"custom_collection_site\",  \"language_help\" : \"\",  \"display_column\" : \"0\",  \"display_order\" : \"3\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"1\",  \"sfi_id\" : \"155\",  \"sfo_id\" : \"164\" }, {  \"field\" : \"collection_datetime\",  \"plugin\" : \"Inventorymanagement\",  \"model\" : \"Collection\",  \"tablename\" : \"collections\",  \"language_label\" : \"collection datetime\",  \"language_tag\" : \"\",  \"type\" : \"datetime\",  \"setting\" : \"\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"inv_collection_datetime_defintion\",  \"display_column\" : \"0\",  \"display_order\" : \"4\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"1\",  \"sfi_id\" : \"156\",  \"sfo_id\" : \"165\" }, {  \"field\" : \"sop_master_id\",  \"plugin\" : \"Inventorymanagement\",  \"model\" : \"Collection\",  \"tablename\" : \"collections\",  \"language_label\" : \"collection sop\",  \"language_tag\" : \"\",  \"type\" : \"select\",  \"setting\" : \"\",  \"default\" : \"\",  \"structure_value_domain\" : \"collection_sop_list\",  \"language_help\" : \"\",  \"display_column\" : \"0\",  \"display_order\" : \"11\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"0\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"0\",  \"sfi_id\" : \"159\",  \"sfo_id\" : \"168\" }, {  \"field\" : \"collection_notes\",  \"plugin\" : \"Inventorymanagement\",  \"model\" : \"Collection\",  \"tablename\" : \"collections\",  \"language_label\" : \"notes\",  \"language_tag\" : \"\",  \"type\" : \"textarea\",  \"setting\" : \"cols=30,rows=4\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"\",  \"display_column\" : \"0\",  \"display_order\" : \"13\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"0\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"0\",  \"sfi_id\" : \"160\",  \"sfo_id\" : \"169\" }, {  \"field\" : \"collection_property\",  \"plugin\" : \"Inventorymanagement\",  \"model\" : \"Collection\",  \"tablename\" : \"collections\",  \"language_label\" : \"collection property\",  \"language_tag\" : \"\",  \"type\" : \"select\",  \"setting\" : \"\",  \"default\" : \"\",  \"structure_value_domain\" : \"collection_property\",  \"language_help\" : \"inv_collection_type_defintion\",  \"display_column\" : \"0\",  \"display_order\" : \"12\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"0\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"0\",  \"sfi_id\" : \"166\",  \"sfo_id\" : \"174\" }, {  \"field\" : \"field1\",  \"plugin\" : \" \",  \"model\" : \"Generated\",  \"tablename\" : \" \",  \"language_label\" : \"\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"\",  \"display_column\" : \"0\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_confidential\" : \"0\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"1\",  \"flag_edit\" : \"0\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"0\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"0\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"0\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_batchedit\" : \"0\",  \"flag_batchedit_readonly\" : \"0\",  \"flag_index\" : \"0\",  \"flag_detail\" : \"0\",  \"flag_summary\" : \"0\",  \"sfi_id\" : \"955\",  \"sfo_id\" : \"2531\" } ] }",
		"result" => "UPDATE structure_formats SET `flag_override_label`='0', `language_label`='' WHERE structure_id=(SELECT id FROM structures WHERE alias='collections') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`=' ' AND `field`='field1' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "Disabling language override in collections.field1 (participant identifier)"
	);
	
	$tests[] = array(
		"test" => "{\"global\" : { \"alias\" : \"login\",  \"language_title\" : \"\"}, \"fields\" : [ {  \"field\" : \"password\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"password\",  \"language_tag\" : \"\",  \"type\" : \"password\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"2\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"23\",  \"sfo_id\" : \"51\" , \"flag_confidential\" : \"0\"  }, {  \"field\" : \"username2\",  \"plugin\" : \"Administrate\",  \"model\" : \"User\",  \"tablename\" : \"users\",  \"language_label\" : \"username\",  \"language_tag\" : \"\",  \"type\" : \"input\",  \"setting\" : \"size=20\",  \"default\" : \"\",  \"structure_value_domain\" : \"NULL\",  \"language_help\" : \"login_help\",  \"display_column\" : \"1\",  \"display_order\" : \"1\",  \"language_heading\" : \"\",  \"flag_add\" : \"1\",  \"flag_add_readonly\" : \"0\",  \"flag_edit\" : \"1\",  \"flag_edit_readonly\" : \"0\",  \"flag_search\" : \"1\",  \"flag_search_readonly\" : \"0\",  \"flag_addgrid\" : \"1\",  \"flag_addgrid_readonly\" : \"0\",  \"flag_editgrid\" : \"1\",  \"flag_editgrid_readonly\" : \"0\",  \"flag_index\" : \"1\",  \"flag_detail\" : \"1\",  \"flag_summary\" : \"1\", \"flag_batchedit\" : \"0\", \"flag_batchedit_readonly\" : \"0\", \"sfi_id\" : \"1\",  \"sfo_id\" : \"50\" , \"flag_confidential\" : \"0\"  } ] }",
		"result" => "INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('Administrate', 'User', 'users', 'username2', 'input',  NULL , '0', 'size=20', '', 'login_help', 'username', '');
INSERT INTO structure_validations (`structure_field_id`, `rule`, `on_action`, `language_message`) 
(SELECT (SELECT id FROM structure_fields WHERE model='User' AND tablename='users' AND field='username2' AND `type`='input' AND structure_value_domain IS NULL ), `rule`, `on_action`, `language_message` FROM structure_validations WHERE structure_field_id=(SELECT id FROM structure_fields WHERE model='User' AND tablename='users' AND field='username' AND `type`='input' AND structure_value_domain  IS NULL )) ;
UPDATE structure_formats SET `structure_field_id`=(SELECT `id` FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username2' AND `type`='input' AND `structure_value_domain` IS NULL ) WHERE structure_id=(SELECT id FROM structures WHERE alias='login') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='User' AND `tablename`='users' AND `field`='username' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');",
		"description" => "login.username -> login.username2"
	);

?>
<!DOCTYPE html/>
<html>
<head>
<script src="../common/js/jquery-1.4.2.min.js"></script>
<style>
span.w{
	color: green;
}
span.f{
	color: red;
}
</style>
</head>
<body>
<table>
	<?php 
	foreach($tests as $test){
		?>
		<tr>
			<th><?php echo $test['description']; ?></th>
			<td>
			<?php 
				$_GET['json'] = $test['test'];
				ob_start();
				require("sqlGenerator.php");
				$result = trim(ob_get_contents());
				ob_end_clean();
				echo $result == $test['result'] ? "<span class='w'>Passed</span>" : "<span class='f'>Failed</span></td><td><pre>".$result."</pre>";
			?>
			</td>
		</tr>
		<?php 
	}
	?>
</table>


</body>
</html>
